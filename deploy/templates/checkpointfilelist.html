<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>{{.Title}} - 档案建档统计</title>
    <style>
        body { 
            margin: 0; 
            padding: 0; 
            font-family: "Microsoft YaHei", sans-serif; 
            display: flex; 
            height: 100vh; 
        }
        
        /* 左侧导航 */
        .sidebar { 
            width: 220px; 
            background-color: #2c3e50; 
            color: white; 
            display: flex; 
            flex-direction: column; 
        }
        .sidebar h3 { 
            text-align: center; 
            padding: 20px 0; 
            border-bottom: 1px solid #34495e; 
            margin: 0; 
        }
        .menu-item { 
            padding: 15px 20px; 
            color: #ecf0f1; 
            text-decoration: none; 
            display: block; 
            border-bottom: 1px solid #34495e; 
        }
        .menu-item:hover { 
            background-color: #34495e; 
        }
        .menu-item.active { 
            background-color: #3498db; 
        }
        
        /* 子菜单样式 */
        .submenu-item {
            padding: 12px 20px 12px 40px;
            color: #bdc3c7;
            text-decoration: none;
            display: block;
            border-bottom: 1px solid #34495e;
            font-size: 14px;
        }
        .submenu-item:hover {
            background-color: #34495e;
        }
        .submenu-item.active {
            background-color: #2980b9;
            color: white;
        }

        /* 右侧内容 */
        .content { 
            flex: 1; 
            padding: 20px; 
            overflow-y: auto; 
            background-color: #f5f6fa; 
        }
        
        /* 搜索/操作区 */
        .search-container { 
            background: white; 
            padding: 20px; 
            border-radius: 5px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); 
            margin-bottom: 20px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
        }
        .search-form { 
            display: flex; 
            align-items: center; 
        }
        .search-form input, 
        .search-form button, 
        .action-btn { 
            padding: 8px; 
            border-radius: 4px; 
            margin-right: 10px; 
        }
        .search-form input { 
            border: 1px solid #ddd; 
            width: 180px; 
        }
        
        .search-form button { 
            background-color: #3498db; 
            color: white; 
            border: none; 
            cursor: pointer; 
        }
        .search-form button:hover { 
            background-color: #2980b9; 
        }

        /* 导入/导出按钮样式 */
        .action-btn { 
            text-decoration: none; 
            color: white; 
            border: none; 
            cursor: pointer;
            display: inline-block;
            text-align: center;
        }
        .export-btn { 
            background-color: #27ae60; 
        }
        .export-btn:hover { 
            background-color: #229954; 
        }

        /* 表格 */
        table { 
            width: 100%; 
            border-collapse: collapse; 
            background: white; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); 
        }
        th, td { 
            padding: 12px 15px; 
            text-align: left; 
            border-bottom: 1px solid #eee; 
            font-size: 14px; 
        }
        th { 
            background-color: #f8f9fa; 
            font-weight: 600; 
            color: #2c3e50; 
        }
        tr:hover { 
            background-color: #f1f1f1; 
        }

        /* 分页 */
        .pagination { 
            margin-top: 20px; 
            display: flex; 
            justify-content: flex-end; 
            align-items: center; 
        }
        .page-btn { 
            padding: 5px 15px; 
            border: 1px solid #ddd; 
            background: white; 
            text-decoration: none; 
            color: #333; 
            margin-left: 5px; 
            border-radius: 4px; 
        }
        .page-btn:hover { 
            background-color: #f8f9fa; 
        }
        .page-info { 
            margin-right: 15px; 
            color: #666; 
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <h3>档案建档统计</h3>
        <a href="/stats" class="menu-item {{if eq .ActiveMenu "stats"}}active{{end}}">统计信息</a>
        <a href="/device/filelist" class="menu-item {{if eq .ActiveMenu "filelist"}}active{{end}}">建档明细</a>
        <a href="/device/filelist" class="submenu-item {{if eq .SubMenu "device_filelist"}}active{{end}}">设备建档明细</a>
        <a href="/checkpoint/filelist" class="submenu-item {{if eq .SubMenu "checkpoint_filelist"}}active{{end}}">卡口建档明细</a>
        <a href="/audit" class="menu-item {{if eq .ActiveMenu "audit"}}active{{end}}">档案审核</a>
        <a href="/audit/progress" class="submenu-item {{if eq .SubMenu "audit_progress"}}active{{end}}">设备审核进度</a>
        <a href="/checkpoint/progress" class="submenu-item {{if eq .SubMenu "checkpoint_progress"}}active{{end}}">卡口审核进度</a>
        <a href="/audit/statistics" class="submenu-item {{if eq .SubMenu "audit_statistics"}}active{{end}}">月度建档数据</a>
        <a href="/users" class="menu-item {{if eq .ActiveMenu "settings"}}active{{end}}">系统设置</a>
        <a href="/users" class="submenu-item {{if eq .SubMenu "users"}}active{{end}}">用户信息</a>
        <a href="/logs" class="submenu-item {{if eq .SubMenu "logs"}}active{{end}}">操作日志</a>
    </div>

    <div class="content">
        
        <!-- 搜索和操作区 -->
        <div class="search-container">
            
            <form class="search-form" action="/checkpoint/filelist" method="GET" style="flex-wrap: wrap; gap: 10px;">
                <input type="text" name="checkpoint_code" placeholder="输入卡口编码" value="{{.SearchCode}}">
                <input type="text" name="checkpoint_name" placeholder="输入卡口名称" value="{{.SearchName}}">
                <label style="font-weight: 600; color: #2c3e50;">月份查询:</label>
                <input type="month" name="month" value="{{.Month}}" placeholder="选择月份" style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                <label style="font-weight: 600; color: #2c3e50;">建档状态:</label>
                <select name="audit_status" style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="">全部</option>
                    <option value="0" {{if eq .AuditStatus "0"}}selected{{end}}>未审核未建档</option>
                    <option value="1" {{if eq .AuditStatus "1"}}selected{{end}}>已审核未建档</option>
                    <option value="2" {{if eq .AuditStatus "2"}}selected{{end}}>已建档</option>
                </select>
                <button type="submit">查询</button>
                {{if or .SearchCode .SearchName .Month .AuditStatus}}
                <a href="/checkpoint/filelist" style="padding: 8px 15px; background-color: #95a5a6; color: white; text-decoration: none; border-radius: 4px;">清除</a>
                {{end}}
            </form>

            <div class="search-form">
                <a href="/checkpoint/filelist/export{{if .Query}}?{{.Query}}{{end}}" class="action-btn export-btn">导出 XLSX</a>
            </div>
        </div>

        <!-- 数据表格 -->
        <table>
            <thead>
                <tr>
                    <th>序号</th>
                    <th>卡口编码</th>
                    <th>卡口名称</th>
                    <th>行政区域</th>
                    <th>监控点类型</th>
                    <th>管理单位</th>
                    <th>维护单位</th>
                    <th>建档状态</th>
                    <th>更新时间</th>
                </tr>
            </thead>
            <tbody>
                {{range .List}}
                <tr>
                    <td>{{.ID}}</td>
                    <td>{{.CheckpointCode}}</td>
                    <td>{{.CheckpointName}}</td>
                    <td>{{.DivisionCode}}</td>
                    <td>{{.CheckpointPointType}}</td>
                    <td>{{.ManagementUnit}}</td>
                    <td>{{.CheckpointMaintainUnit}}</td>
                    <td>{{getAuditStatusText .AuditStatus}}</td>
                    <td>{{.UpdateTime}}</td>
                </tr>
                {{else}}
                <tr>
                    <td colspan="9" style="text-align: center; padding: 20px; color: #999;">暂无数据</td>
                </tr>
                {{end}}
            </tbody>
        </table>

        <!-- 分页 -->
        <div class="pagination">
            <span class="page-info">第 {{.CurrentPage}} / {{.TotalPages}} 页</span>
            {{if gt .CurrentPage .FirstPage}}
            <a href="/checkpoint/filelist?page={{.FirstPage}}{{if .Query}}&{{.Query}}{{end}}" class="page-btn">首页</a>
            {{end}}
            {{if .HasPrev}}
            <a href="/checkpoint/filelist?page={{.PrevPage}}{{if .Query}}&{{.Query}}{{end}}" class="page-btn">上一页</a>
            {{end}}
            {{if .HasNext}}
            <a href="/checkpoint/filelist?page={{.NextPage}}{{if .Query}}&{{.Query}}{{end}}" class="page-btn">下一页</a>
            {{end}}
            {{if lt .CurrentPage .LastPage}}
            <a href="/checkpoint/filelist?page={{.LastPage}}{{if .Query}}&{{.Query}}{{end}}" class="page-btn">最后一页</a>
            {{end}}
        </div>

    </div>

</body>
</html>
