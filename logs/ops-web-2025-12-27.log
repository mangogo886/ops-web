2025/12/27 13:32:56 logger.go:45: [ERROR] 设备审核录像提醒定时任务已启动，将根据配置执行
2025/12/27 13:32:56 logger.go:45: [ERROR] 定时任务已配置：每天 10:00，下次执行时间：2025-12-28 10:00:00，等待 20h27m3.5486855s
2025/12/27 13:33:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:33:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:33:08 logger.go:45: [ERROR] 数据概览-查询失败: sql: Scan error on column index 1, name "pending": converting NULL to int is unsupported, SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	
2025/12/27 13:33:08 logger.go:45: [ERROR] 获取设备统计数据失败: 查询设备统计数据失败: sql: Scan error on column index 1, name "pending": converting NULL to int is unsupported
2025/12/27 13:33:09 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:33:09 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:33:09 logger.go:45: [ERROR] 数据概览-查询失败: sql: Scan error on column index 1, name "pending": converting NULL to int is unsupported, SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	
2025/12/27 13:33:09 logger.go:45: [ERROR] 获取设备统计数据失败: 查询设备统计数据失败: sql: Scan error on column index 1, name "pending": converting NULL to int is unsupported
2025/12/27 13:33:10 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:33:10 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
	, 参数: [], 时间范围: month
2025/12/27 13:33:10 logger.go:45: [ERROR] 数据概览-查询失败: sql: Scan error on column index 1, name "pending": converting NULL to int is unsupported, SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
	
2025/12/27 13:33:10 logger.go:45: [ERROR] 获取设备统计数据失败: 查询设备统计数据失败: sql: Scan error on column index 1, name "pending": converting NULL to int is unsupported
2025/12/27 13:33:11 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:33:11 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:33:11 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=0, NeedFix=1
2025/12/27 13:33:13 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:33:13 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
	, 参数: [], 时间范围: month
2025/12/27 13:33:13 logger.go:45: [ERROR] 数据概览-查询失败: sql: Scan error on column index 1, name "pending": converting NULL to int is unsupported, SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
	
2025/12/27 13:33:13 logger.go:45: [ERROR] 获取设备统计数据失败: 查询设备统计数据失败: sql: Scan error on column index 1, name "pending": converting NULL to int is unsupported
2025/12/27 13:33:13 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:33:13 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:33:13 logger.go:45: [ERROR] 数据概览-查询失败: sql: Scan error on column index 1, name "pending": converting NULL to int is unsupported, SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	
2025/12/27 13:33:13 logger.go:45: [ERROR] 获取设备统计数据失败: 查询设备统计数据失败: sql: Scan error on column index 1, name "pending": converting NULL to int is unsupported
2025/12/27 13:33:43 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:33:43 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:33:43 logger.go:45: [ERROR] 数据概览-查询失败: sql: Scan error on column index 1, name "pending": converting NULL to int is unsupported, SQL: 
		SELECT 
			COUNT(*) as total,
			SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END) as pending,
			SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	
2025/12/27 13:33:43 logger.go:45: [ERROR] 获取设备统计数据失败: 查询设备统计数据失败: sql: Scan error on column index 1, name "pending": converting NULL to int is unsupported
2025/12/27 13:34:18 logger.go:45: [ERROR] 设备审核录像提醒定时任务已启动，将根据配置执行
2025/12/27 13:34:18 logger.go:45: [ERROR] 定时任务已配置：每天 10:00，下次执行时间：2025-12-28 10:00:00，等待 20h25m41.5090693s
2025/12/27 13:34:32 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:34:32 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:34:32 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:34:34 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:34:34 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:34:34 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:34:35 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:34:35 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
	, 参数: [], 时间范围: month
2025/12/27 13:34:35 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:34:37 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:34:37 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:34:37 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=0, NeedFix=1
2025/12/27 13:34:39 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:34:39 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
	, 参数: [], 时间范围: month
2025/12/27 13:34:39 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:34:40 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:34:40 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:34:40 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:34:47 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:34:47 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:34:47 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=0, NeedFix=1
2025/12/27 13:34:50 logger.go:57: [INFO] [EventHub] 客户端连接: 1_1766813690286979600 (用户ID: 1, 总数: 1)
2025/12/27 13:34:50 logger.go:57: [INFO] [SSEHandler] 客户端已注册: 1_1766813690286979600 (用户ID: 1)
2025/12/27 13:34:50 logger.go:57: [INFO] [SSEHandler] 初始连接消息已发送
2025/12/27 13:34:53 logger.go:57: [INFO] [SSEHandler] 客户端断开连接: 1_1766813690286979600
2025/12/27 13:34:53 logger.go:57: [INFO] [EventHub] 客户端断开: 1_1766813690286979600 (剩余: 0)
2025/12/27 13:34:57 logger.go:57: [INFO] [EventHub] 广播任务更新事件: taskID=80, data=map[audit_comment: audit_status:未审核 is_fixed:false updated_by:admin]
2025/12/27 13:34:57 logger.go:57: [INFO] [EventHub] 事件已加入广播队列: type=task_updated, taskID=80
2025/12/27 13:34:57 logger.go:57: [INFO] [EventHub] 开始广播事件给 0 个客户端: type=task_updated, taskID=80
2025/12/27 13:34:57 logger.go:57: [INFO] [EventHub] 警告: 没有活跃的客户端连接，事件将被丢弃
2025/12/27 13:34:57 logger.go:57: [INFO] [EventHub] 事件已发送给 0/0 个客户端
2025/12/27 13:34:58 logger.go:57: [INFO] [SSEHandler] 客户端已注册: 1_1766813698406841700 (用户ID: 1)
2025/12/27 13:34:58 logger.go:57: [INFO] [EventHub] 客户端连接: 1_1766813698406841700 (用户ID: 1, 总数: 1)
2025/12/27 13:34:58 logger.go:57: [INFO] [SSEHandler] 初始连接消息已发送
2025/12/27 13:34:59 logger.go:57: [INFO] [SSEHandler] 客户端断开连接: 1_1766813698406841700
2025/12/27 13:34:59 logger.go:57: [INFO] [EventHub] 客户端断开: 1_1766813698406841700 (剩余: 0)
2025/12/27 13:34:59 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:34:59 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:34:59 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:35:00 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:35:00 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:35:00 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:35:02 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:35:02 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:35:02 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:35:04 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:35:04 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
	, 参数: [], 时间范围: month
2025/12/27 13:35:04 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:35:06 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:35:06 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:35:06 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:35:15 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:35:15 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
	, 参数: [], 时间范围: month
2025/12/27 13:35:15 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:35:16 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:35:16 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:35:16 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:35:17 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:35:17 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
	, 参数: [], 时间范围: month
2025/12/27 13:35:17 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:35:18 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:35:18 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:35:18 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:35:30 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:35:30 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:35:30 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:35:31 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:35:31 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
	, 参数: [], 时间范围: month
2025/12/27 13:35:31 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:35:52 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:35:52 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:35:52 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:35:53 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:35:53 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:35:53 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:36:02 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:36:02 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
	, 参数: [], 时间范围: month
2025/12/27 13:36:02 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:36:04 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:36:04 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:36:04 logger.go:57: [INFO] 数据概览-查询结果: Total=0, Pending=0, NeedFix=0
2025/12/27 13:36:20 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:36:20 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
	, 参数: [], 时间范围: week
2025/12/27 13:36:20 logger.go:57: [INFO] 数据概览-查询结果: Total=1, Pending=1, NeedFix=0
2025/12/27 13:36:22 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:36:22 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
	, 参数: [], 时间范围: month
2025/12/27 13:36:22 logger.go:57: [INFO] 数据概览-查询结果: Total=1, Pending=1, NeedFix=0
2025/12/27 13:36:24 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:36:24 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:36:24 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:36:54 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:36:54 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:36:54 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:37:24 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:37:24 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:37:24 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:37:54 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:37:54 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			0 as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:37:54 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:38:17 logger.go:45: [ERROR] 设备审核录像提醒定时任务已启动，将根据配置执行
2025/12/27 13:38:17 logger.go:45: [ERROR] 定时任务已配置：每天 10:00，下次执行时间：2025-12-28 10:00:00，等待 20h21m42.0710862s
2025/12/27 13:38:29 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:38:29 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:38:29 logger.go:57: [INFO] 数据概览-查询结果: Total=1, Pending=1, NeedFix=0
2025/12/27 13:38:32 logger.go:57: [INFO] [EventHub] 客户端连接: 1_1766813912404238700 (用户ID: 1, 总数: 1)
2025/12/27 13:38:32 logger.go:57: [INFO] [SSEHandler] 客户端已注册: 1_1766813912404238700 (用户ID: 1)
2025/12/27 13:38:32 logger.go:57: [INFO] [SSEHandler] 初始连接消息已发送
2025/12/27 13:38:34 logger.go:57: [INFO] [SSEHandler] 客户端断开连接: 1_1766813912404238700
2025/12/27 13:38:34 logger.go:57: [INFO] [EventHub] 客户端断开: 1_1766813912404238700 (剩余: 0)
2025/12/27 13:38:34 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:38:34 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:38:34 logger.go:57: [INFO] 数据概览-查询结果: Total=1, Pending=1, NeedFix=0
2025/12/27 13:38:37 logger.go:57: [INFO] [SSEHandler] 客户端已注册: 1_1766813917781599100 (用户ID: 1)
2025/12/27 13:38:37 logger.go:57: [INFO] [EventHub] 客户端连接: 1_1766813917781599100 (用户ID: 1, 总数: 1)
2025/12/27 13:38:37 logger.go:57: [INFO] [SSEHandler] 初始连接消息已发送
2025/12/27 13:38:53 logger.go:57: [INFO] [SSEHandler] 客户端断开连接: 1_1766813917781599100
2025/12/27 13:38:53 logger.go:57: [INFO] [EventHub] 客户端断开: 1_1766813917781599100 (剩余: 0)
2025/12/27 13:38:53 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:38:53 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:38:53 logger.go:57: [INFO] 数据概览-查询结果: Total=1, Pending=1, NeedFix=0
2025/12/27 13:39:04 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:39:04 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:39:04 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:39:06 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:39:06 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 1 MONTH))
		)
	, 参数: [], 时间范围: month
2025/12/27 13:39:06 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:39:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:39:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:39:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:39:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:39:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:39:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:40:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:40:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:40:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:40:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:40:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:40:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:41:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:41:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:41:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:41:25 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:41:25 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:41:25 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:41:55 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:41:55 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:41:55 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:42:25 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:42:25 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:42:25 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:42:55 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:42:55 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:42:55 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:43:25 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:43:25 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:43:25 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:43:55 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:43:55 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:43:55 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:44:25 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:44:25 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:44:25 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:44:55 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:44:55 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:44:55 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:45:25 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:45:25 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:45:25 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:45:55 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:45:55 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:45:55 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:46:43 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:46:43 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:46:43 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:46:55 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:46:55 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:46:55 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:47:25 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:47:25 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:47:25 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:47:55 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:47:55 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			0 as pending_sample,
			0 as sample_need_fix,
			0 as sample_passed
		FROM audit_tasks at
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR (at.audit_status = '已完成' AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:47:55 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0
2025/12/27 13:48:14 logger.go:45: [ERROR] 设备审核录像提醒定时任务已启动，将根据配置执行
2025/12/27 13:48:14 logger.go:45: [ERROR] 定时任务已配置：每天 10:00，下次执行时间：2025-12-28 10:00:00，等待 20h11m45.8749193s
2025/12/27 13:48:26 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:48:26 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:48:26 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=0, SamplePassed=1
2025/12/27 13:48:30 logger.go:57: [INFO] [SSEHandler] 客户端已注册: 1_1766814510189055300 (用户ID: 1)
2025/12/27 13:48:30 logger.go:57: [INFO] [EventHub] 客户端连接: 1_1766814510189055300 (用户ID: 1, 总数: 1)
2025/12/27 13:48:30 logger.go:57: [INFO] [SSEHandler] 初始连接消息已发送
2025/12/27 13:48:33 logger.go:57: [INFO] [SSEHandler] 客户端断开连接: 1_1766814510189055300
2025/12/27 13:48:33 logger.go:57: [INFO] [EventHub] 客户端断开: 1_1766814510189055300 (剩余: 0)
2025/12/27 13:48:33 logger.go:57: [INFO] [CheckpointSSEHandler] 客户端已注册: 1_1766814513148398100 (用户ID: 1)
2025/12/27 13:48:33 logger.go:57: [INFO] [EventHub] 客户端连接: 1_1766814513148398100 (用户ID: 1, 总数: 1)
2025/12/27 13:48:33 logger.go:57: [INFO] [CheckpointSSEHandler] 初始连接消息已发送
2025/12/27 13:48:34 logger.go:57: [INFO] [CheckpointSSEHandler] 客户端断开连接: 1_1766814513148398100
2025/12/27 13:48:34 logger.go:57: [INFO] [EventHub] 客户端断开: 1_1766814513148398100 (剩余: 0)
2025/12/27 13:48:34 logger.go:57: [INFO] [SSEHandler] 客户端已注册: 1_1766814514274821000 (用户ID: 1)
2025/12/27 13:48:34 logger.go:57: [INFO] [EventHub] 客户端连接: 1_1766814514274821000 (用户ID: 1, 总数: 1)
2025/12/27 13:48:34 logger.go:57: [INFO] [SSEHandler] 初始连接消息已发送
2025/12/27 13:48:37 logger.go:57: [INFO] [SSEHandler] 客户端断开连接: 1_1766814514274821000
2025/12/27 13:48:37 logger.go:57: [INFO] [EventHub] 客户端断开: 1_1766814514274821000 (剩余: 0)
2025/12/27 13:48:37 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:48:37 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:48:37 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=0, SamplePassed=1
2025/12/27 13:48:40 logger.go:57: [INFO] [SSEHandler] 客户端已注册: 1_1766814520928229500 (用户ID: 1)
2025/12/27 13:48:40 logger.go:57: [INFO] [EventHub] 客户端连接: 1_1766814520928229500 (用户ID: 1, 总数: 1)
2025/12/27 13:48:41 logger.go:57: [INFO] [SSEHandler] 初始连接消息已发送
2025/12/27 13:48:45 logger.go:57: [INFO] [SSEHandler] 客户端断开连接: 1_1766814520928229500
2025/12/27 13:48:45 logger.go:57: [INFO] [EventHub] 客户端断开: 1_1766814520928229500 (剩余: 0)
2025/12/27 13:48:45 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:48:45 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:48:45 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=0, SamplePassed=1
2025/12/27 13:49:15 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:49:15 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:49:15 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=0, SamplePassed=1
2025/12/27 13:49:45 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:49:45 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:49:45 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=0, SamplePassed=1
2025/12/27 13:50:11 logger.go:57: [INFO] [SSEHandler] 客户端已注册: 1_1766814611547011600 (用户ID: 1)
2025/12/27 13:50:11 logger.go:57: [INFO] [EventHub] 客户端连接: 1_1766814611547011600 (用户ID: 1, 总数: 1)
2025/12/27 13:50:11 logger.go:57: [INFO] [SSEHandler] 初始连接消息已发送
2025/12/27 13:50:14 logger.go:57: [INFO] [SSEHandler] 客户端断开连接: 1_1766814611547011600
2025/12/27 13:50:14 logger.go:57: [INFO] [EventHub] 客户端断开: 1_1766814611547011600 (剩余: 0)
2025/12/27 13:50:17 logger.go:57: [INFO] [EventHub] 事件已加入广播队列: type=task_sampled, taskID=78
2025/12/27 13:50:17 logger.go:57: [INFO] [EventHub] 开始广播事件给 0 个客户端: type=task_sampled, taskID=78
2025/12/27 13:50:17 logger.go:57: [INFO] [EventHub] 警告: 没有活跃的客户端连接，事件将被丢弃
2025/12/27 13:50:17 logger.go:57: [INFO] [EventHub] 事件已发送给 0/0 个客户端
2025/12/27 13:50:17 logger.go:57: [INFO] [SSEHandler] 客户端已注册: 1_1766814617674489000 (用户ID: 1)
2025/12/27 13:50:17 logger.go:57: [INFO] [EventHub] 客户端连接: 1_1766814617674489000 (用户ID: 1, 总数: 1)
2025/12/27 13:50:17 logger.go:57: [INFO] [SSEHandler] 初始连接消息已发送
2025/12/27 13:50:19 logger.go:57: [INFO] [SSEHandler] 客户端断开连接: 1_1766814617674489000
2025/12/27 13:50:19 logger.go:57: [INFO] [EventHub] 客户端断开: 1_1766814617674489000 (剩余: 0)
2025/12/27 13:50:19 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:50:19 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:50:19 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:50:49 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:50:49 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:50:49 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:51:19 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:51:19 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:51:19 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:51:49 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:51:49 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:51:49 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:52:19 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:52:19 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:52:19 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:52:49 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:52:49 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:52:49 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:53:19 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:53:19 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:53:19 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:53:38 logger.go:45: [ERROR] 设备审核录像提醒定时任务已启动，将根据配置执行
2025/12/27 13:53:38 logger.go:45: [ERROR] 定时任务已配置：每天 10:00，下次执行时间：2025-12-28 10:00:00，等待 20h6m21.3269383s
2025/12/27 13:53:47 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:53:47 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:53:47 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:53:58 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:53:58 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 1 MONTH))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 1 MONTH))
		)
	, 参数: [], 时间范围: month
2025/12/27 13:53:58 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:54:00 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:54:00 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:54:00 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:54:01 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:54:01 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:54:01 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:54:31 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:54:31 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:54:31 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:55:01 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:55:01 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:55:01 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:55:07 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:55:07 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:55:07 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:55:07 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:55:07 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 1 MONTH))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 1 MONTH))
		)
	, 参数: [], 时间范围: month
2025/12/27 13:55:07 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:55:37 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: month
2025/12/27 13:55:37 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 1 MONTH))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 1 MONTH))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 1 MONTH))
		)
	, 参数: [], 时间范围: month
2025/12/27 13:55:37 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:56:01 logger.go:57: [INFO] [CheckpointSSEHandler] 客户端已注册: 1_1766814961839940100 (用户ID: 1)
2025/12/27 13:56:01 logger.go:57: [INFO] [EventHub] 客户端连接: 1_1766814961839940100 (用户ID: 1, 总数: 1)
2025/12/27 13:56:01 logger.go:57: [INFO] [CheckpointSSEHandler] 初始连接消息已发送
2025/12/27 13:56:08 logger.go:57: [INFO] [CheckpointSSEHandler] 客户端断开连接: 1_1766814961839940100
2025/12/27 13:56:08 logger.go:57: [INFO] [EventHub] 客户端断开: 1_1766814961839940100 (剩余: 0)
2025/12/27 13:56:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:56:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:56:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:56:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 13:56:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 13:56:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:56:54 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:56:54 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:56:54 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:57:24 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:57:24 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:57:24 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:57:54 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:57:54 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:57:54 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:58:24 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:58:24 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:58:24 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:58:54 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:58:54 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:58:54 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:59:24 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:59:24 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:59:24 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 13:59:54 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: all
2025/12/27 13:59:54 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 
	, 参数: [], 时间范围: all
2025/12/27 13:59:54 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0
2025/12/27 14:00:57 logger.go:45: [ERROR] 设备审核录像提醒定时任务已启动，将根据配置执行
2025/12/27 14:00:57 logger.go:45: [ERROR] 定时任务已配置：每天 10:00，下次执行时间：2025-12-28 10:00:00，等待 19h59m2.5050538s
2025/12/27 14:01:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:01:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed,
			-- 已打标签档案数量：tag字段不为NULL且不为空字符串
			COALESCE(SUM(CASE WHEN at.tag IS NOT NULL AND at.tag != '' THEN 1 ELSE 0 END), 0) as tagged_count
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:01:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedCount=2
2025/12/27 14:01:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:01:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed,
			-- 已打标签档案数量：tag字段不为NULL且不为空字符串
			COALESCE(SUM(CASE WHEN at.tag IS NOT NULL AND at.tag != '' THEN 1 ELSE 0 END), 0) as tagged_count
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:01:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedCount=2
2025/12/27 14:02:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:02:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed,
			-- 已打标签档案数量：tag字段不为NULL且不为空字符串
			COALESCE(SUM(CASE WHEN at.tag IS NOT NULL AND at.tag != '' THEN 1 ELSE 0 END), 0) as tagged_count
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:02:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedCount=2
2025/12/27 14:02:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:02:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed,
			-- 已打标签档案数量：tag字段不为NULL且不为空字符串
			COALESCE(SUM(CASE WHEN at.tag IS NOT NULL AND at.tag != '' THEN 1 ELSE 0 END), 0) as tagged_count
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:02:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedCount=2
2025/12/27 14:03:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:03:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed,
			-- 已打标签档案数量：tag字段不为NULL且不为空字符串
			COALESCE(SUM(CASE WHEN at.tag IS NOT NULL AND at.tag != '' THEN 1 ELSE 0 END), 0) as tagged_count
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:03:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedCount=2
2025/12/27 14:03:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:03:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed,
			-- 已打标签档案数量：tag字段不为NULL且不为空字符串
			COALESCE(SUM(CASE WHEN at.tag IS NOT NULL AND at.tag != '' THEN 1 ELSE 0 END), 0) as tagged_count
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:03:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedCount=2
2025/12/27 14:04:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:04:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed,
			-- 已打标签档案数量：tag字段不为NULL且不为空字符串
			COALESCE(SUM(CASE WHEN at.tag IS NOT NULL AND at.tag != '' THEN 1 ELSE 0 END), 0) as tagged_count
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:04:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedCount=2
2025/12/27 14:04:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:04:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed,
			-- 已打标签档案数量：tag字段不为NULL且不为空字符串
			COALESCE(SUM(CASE WHEN at.tag IS NOT NULL AND at.tag != '' THEN 1 ELSE 0 END), 0) as tagged_count
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:04:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedCount=2
2025/12/27 14:05:15 logger.go:45: [ERROR] 设备审核录像提醒定时任务已启动，将根据配置执行
2025/12/27 14:05:15 logger.go:45: [ERROR] 定时任务已配置：每天 10:00，下次执行时间：2025-12-28 10:00:00，等待 19h54m44.9895572s
2025/12/27 14:05:27 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:05:27 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:05:27 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:05:27 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:05:34 logger.go:57: [INFO] [SSEHandler] 客户端已注册: 1_1766815534203002100 (用户ID: 1)
2025/12/27 14:05:34 logger.go:57: [INFO] [EventHub] 客户端连接: 1_1766815534203002100 (用户ID: 1, 总数: 1)
2025/12/27 14:05:34 logger.go:57: [INFO] [SSEHandler] 初始连接消息已发送
2025/12/27 14:05:38 logger.go:57: [INFO] [SSEHandler] 客户端断开连接: 1_1766815534203002100
2025/12/27 14:05:38 logger.go:57: [INFO] [EventHub] 客户端断开: 1_1766815534203002100 (剩余: 0)
2025/12/27 14:05:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:05:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:05:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:05:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:06:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:06:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:06:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:06:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:06:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:06:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:06:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:06:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:07:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:07:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:07:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:07:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:07:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:07:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:07:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:07:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:08:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:08:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:08:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:08:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:08:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:08:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:08:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:08:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:09:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:09:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:09:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:09:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:09:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:09:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:09:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:09:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:10:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:10:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:10:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:10:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:10:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:10:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:10:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:10:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:11:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:11:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:11:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:11:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:11:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:11:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:11:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:11:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:12:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:12:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:12:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:12:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:12:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:12:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:12:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:12:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:13:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:13:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:13:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:13:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:13:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:13:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:13:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:13:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:14:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:14:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:14:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:14:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:14:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:14:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:14:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:14:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:15:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:15:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:15:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:15:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:15:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:15:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:15:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:15:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:16:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:16:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:16:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:16:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:16:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:16:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:16:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:16:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:17:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:17:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:17:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:17:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:17:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:17:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:17:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:17:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:18:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:18:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:18:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:18:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:18:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:18:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:18:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:18:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:19:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:19:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:19:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:19:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:19:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:19:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:19:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:19:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:20:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:20:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:20:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:20:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:20:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:20:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:20:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:20:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:21:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:21:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:21:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:21:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:21:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:21:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:21:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:21:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:22:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:22:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:22:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:22:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:22:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:22:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:22:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:22:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:23:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:23:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:23:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:23:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:23:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:23:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:23:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:23:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:24:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:24:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:24:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:24:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:24:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:24:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:24:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:24:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:25:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:25:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:25:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:25:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:25:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:25:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:25:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:25:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:26:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:26:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:26:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:26:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:26:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:26:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:26:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:26:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:27:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:27:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:27:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:27:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:27:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:27:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:27:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:27:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:28:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:28:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:28:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:28:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:28:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:28:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:28:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:28:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:29:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:29:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:29:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:29:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:29:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:29:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:29:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:29:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:30:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:30:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:30:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:30:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:30:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:30:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:30:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:30:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:31:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:31:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:31:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:31:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:31:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:31:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:31:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:31:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:32:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:32:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:32:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:32:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:32:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:32:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:32:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:32:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:33:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:33:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:33:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:33:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:33:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:33:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:33:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:33:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:34:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:34:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:34:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:34:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:34:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:34:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:34:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:34:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:35:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:35:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:35:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:35:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:35:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:35:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:35:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:35:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:36:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:36:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:36:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:36:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:36:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:36:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:36:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:36:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:37:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:37:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:37:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:37:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:37:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:37:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:37:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:37:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:38:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:38:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:38:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:38:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:38:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:38:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:38:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:38:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:39:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:39:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:39:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:39:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:39:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:39:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:39:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:39:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:40:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:40:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:40:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:40:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:40:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:40:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:40:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:40:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:41:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:41:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:41:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:41:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:41:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:41:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:41:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:41:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:42:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:42:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:42:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:42:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:42:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:42:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:42:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:42:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:43:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:43:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:43:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:43:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:43:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:43:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:43:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:43:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:44:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:44:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:44:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:44:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:44:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:44:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:44:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:44:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:45:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:45:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:45:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:45:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:45:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:45:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:45:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:45:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:46:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:46:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:46:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:46:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:46:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:46:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:46:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:46:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:47:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:47:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:47:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:47:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:47:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:47:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:47:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:47:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:48:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:48:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:48:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:48:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:48:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:48:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:48:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:48:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:49:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:49:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:49:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:49:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:49:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:49:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:49:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:49:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:50:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:50:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:50:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:50:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:50:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:50:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:50:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:50:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:51:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:51:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:51:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:51:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:51:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:51:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:51:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:51:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:52:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:52:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:52:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:52:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:52:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:52:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:52:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:52:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:53:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:53:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:53:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:53:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:53:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:53:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:53:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:53:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:54:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:54:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:54:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:54:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:54:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:54:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:54:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:54:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:55:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:55:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:55:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:55:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:55:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:55:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:55:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:55:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:56:08 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:56:08 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:56:08 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:56:08 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
2025/12/27 14:56:38 logger.go:57: [INFO] 数据概览API-收到请求，时间范围: week
2025/12/27 14:56:38 logger.go:57: [INFO] 数据概览-查询SQL: 
		SELECT 
			COUNT(*) as total,
			COALESCE(SUM(CASE WHEN at.audit_status = '未审核' THEN 1 ELSE 0 END), 0) as pending,
			COALESCE(SUM(CASE WHEN at.audit_status = '已审核待整改' THEN 1 ELSE 0 END), 0) as need_fix,
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' THEN 1 ELSE 0 END), 0) as completed,
			-- 待抽检：已完成且未抽检
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) THEN 1 ELSE 0 END), 0) as pending_sample,
			-- 抽检后待整改：已完成且已抽检，且最近一次抽检结果为"待整改"
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND latest_sample.sample_result = '待整改' 
				THEN 1 ELSE 0 END), 0) as sample_need_fix,
			-- 抽检已通过：已完成且已抽检，且最近一次抽检结果为"通过"或NULL
			COALESCE(SUM(CASE WHEN at.audit_status = '已完成' 
				AND at.is_sampled = 1 
				AND (latest_sample.sample_result = '通过' OR latest_sample.sample_result IS NULL)
				THEN 1 ELSE 0 END), 0) as sample_passed
		FROM audit_tasks at
		LEFT JOIN (
			SELECT 
				asr1.task_id,
				asr1.sample_result
			FROM audit_sample_records asr1
			INNER JOIN (
				SELECT task_id, MAX(sampled_at) as max_sampled_at
				FROM audit_sample_records
				GROUP BY task_id
			) asr2 ON asr1.task_id = asr2.task_id AND asr1.sampled_at = asr2.max_sampled_at
		) latest_sample ON at.id = latest_sample.task_id
		WHERE 1=1 AND (
			(at.audit_status IN ('未审核', '已审核待整改') AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR 
			(at.audit_status = '已完成' AND (at.is_sampled = 0 OR at.is_sampled IS NULL) AND at.completed_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
			OR
			(at.audit_status = '已完成' AND at.is_sampled = 1 AND at.last_sampled_at >= DATE_SUB(NOW(), INTERVAL 7 DAY))
		)
	, 参数: [], 时间范围: week
2025/12/27 14:56:38 logger.go:57: [INFO] 数据概览-tag统计SQL: 
		SELECT 
			at.tag,
			COUNT(*) as count
		FROM audit_tasks at
		WHERE 1=1 
		AND at.tag IS NOT NULL 
		AND at.tag != ''
		AND at.import_time >= DATE_SUB(NOW(), INTERVAL 7 DAY)
		GROUP BY at.tag
		ORDER BY at.tag
	, 时间范围: week
2025/12/27 14:56:38 logger.go:57: [INFO] 数据概览-查询结果: Total=2, Pending=1, NeedFix=0, Completed=1, PendingSample=0, SampleNeedFix=1, SamplePassed=0, TaggedStats=map[全运会:1]
