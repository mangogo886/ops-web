# 许可授权功能说明（可选模式）

## 重要说明

**许可功能已改为可选模式**，系统可以在没有许可文件的情况下正常使用。

## 工作模式

### 模式1：无许可文件（默认模式）
- ✅ **不需要许可文件**，系统可以正常使用
- ✅ 用户可以正常登录和使用所有功能
- ⚠️ 日志中会记录"许可文件不存在，跳过验证"

### 模式2：有许可文件（授权模式）
- ✅ 系统会验证许可文件
- ✅ 检查授权日期是否过期
- ✅ 检查MAC地址是否匹配
- ✅ 如果验证失败，会拒绝登录并提示"系统错误，请联系管理员"

## 行为说明

### 无许可文件时
- 系统正常运行
- 所有功能可用
- 用户登录不受限制
- 日志记录：`许可验证-许可文件不存在，跳过验证`

### 有许可文件时
- 系统会严格验证许可
- 如果许可过期 → 拒绝登录
- 如果MAC地址不匹配 → 拒绝登录
- 如果验证通过 → 正常使用

## 使用场景

### 场景1：开发/测试环境
- **不需要**创建许可文件
- 系统可以直接使用

### 场景2：生产环境（需要授权控制）
- **需要**创建许可文件
- 设置授权期限
- 绑定服务器MAC地址
- 实现授权管理

### 场景3：临时使用
- 可以先不使用许可文件
- 后续需要时再添加许可文件

## 如何启用许可验证

如果需要启用许可验证：

1. **生成许可文件**
   ```bash
   license-generator.exe -expire 2026-12-30 -mac 00:11:22:33:44:55 -output config/license.json
   ```

2. **将许可文件放到 config 目录**
   ```
   config/license.json
   ```

3. **重启系统**
   - 系统会自动检测到许可文件并启用验证

## 如何禁用许可验证

如果需要禁用许可验证：

1. **删除或重命名许可文件**
   ```bash
   # 删除许可文件
   del config\license.json
   
   # 或重命名
   ren config\license.json config\license.json.bak
   ```

2. **重启系统**
   - 系统会检测不到许可文件，自动切换到无验证模式

## 注意事项

1. ⚠️ **许可文件路径固定**：必须是 `config/license.json`
2. ⚠️ **文件存在即启用验证**：只要许可文件存在，就会进行验证
3. ⚠️ **验证失败会拒绝登录**：如果许可文件存在但验证失败，会阻止登录
4. ⚠️ **日志记录**：所有许可验证行为都会记录在日志中

## 日志说明

### 无许可文件时
```
许可验证-许可文件不存在，跳过验证: config/license.json
```

### 有许可文件且验证通过时
```
登录-许可验证通过，用户名: admin
```

### 有许可文件但验证失败时
```
许可验证-授权已过期: 到期日期=2024-12-31
登录-许可验证失败: 系统错误，请联系管理员, 用户名: admin
```

## 总结

- ✅ **无需许可即可使用**：系统可以在没有许可文件的情况下正常运行
- ✅ **可选授权控制**：需要时可以添加许可文件启用授权管理
- ✅ **灵活切换**：可以通过添加或删除许可文件来启用/禁用验证

---

**更新日期**：2024-12-20  
**版本**：1.0（可选模式）

